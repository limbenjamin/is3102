<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:jsf="http://xmlns.jcp.org/jsf"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"></meta>
        <title>Island Furniture - Web Application Admin Dashboard</title>
        <!-- core styles -->
        <link rel="stylesheet" href="#{application.contextPath}/assets/bootstrap/css/bootstrap.min.css"></link>
        <link rel="stylesheet" href="#{application.contextPath}/assets/font-awesome/css/font-awesome.min.css"></link>
        <!-- template styles -->
        <link rel="stylesheet" href="#{application.contextPath}/assets/css/palette.css" id="skin"></link>
        <link rel="stylesheet" href="#{application.contextPath}/assets/css/navigation.css"></link>
        <link rel="stylesheet" href="#{application.contextPath}/assets/css/dashboard.css"></link> 

        <script src="#{application.contextPath}/assets/plugins/modernizr.js"></script>
    </h:head>
    <h:body>
        <div class="app">
            <!-- top header -->
            <header class="header header-fixed navbar">

                <div class="brand">
                    <!-- toggle offscreen menu -->
                    <a href="javascript:;" class="fa fa-bars off-left visible-xs" data-toggle="offscreen" data-move="ltr"></a>
                    <!-- /toggle offscreen menu -->

                    <!-- logo -->
                    <a href="#{application.contextPath}/dash.xhtml" class="navbar-brand">
                        <img src="#{application.contextPath}/assets/img/logo.png" alt=""></img>
                        <span>
                            Island Furniture
                        </span>
                    </a>
                    <!-- /logo -->
                </div>

                <ul class="nav navbar-nav">
                    <li class="hidden-xs">
                        <!-- toggle small menu -->
                        <a href="#" class="toggle-sidebar">
                            <i class="fa fa-bars"></i>
                        </a>
                        <!-- /toggle small menu -->
                    </li>
                    <li class="dashboard-name">
                        <h4>Common Workspace</h4>
                    </li>
                </ul>

                <ul class="nav navbar-nav navbar-right">

                    <li class="notifications dropdown">
                        <a href="#" data-toggle="dropdown">
                            <i class="fa fa-bell"></i>
                            <div class="badge badge-top">
                                <h:form id="updateCount">
                                    <span>#{loginManagedBean.count}</span>
                                    <p:poll interval="3" listener="#{loginManagedBean.pullCount}" update="updateCount" />
                                </h:form>
                            </div>
                        </a>
                        <div class="dropdown-menu">
                            <div class="panel panel-default no-m">
                                <div class="panel-heading small"><b>Notifications</b>
                                </div>
                                <ul class="list-group">
                                    <li class="list-group-item" id="new-notification">
                                        <h:form id="newNotification"> 
                                                <p:remoteCommand name="callbutton" actionListener="#{loginManagedBean.reduceCount}" />
                                                <c:if test="${loginManagedBean.notification != null}">
                                                    <a href="#{application.contextPath}#{loginManagedBean.notification.link}" onclick="callbutton();">
                                                        <div class="m-body">
                                                            <small><h6>#{loginManagedBean.notification.title}:</h6></small>
                                                            <span>#{loginManagedBean.notification.content}</span><br></br>
                                                            <span class="small"><i class="fa fa-clock-o"></i> </span>
                                                        </div>
                                                    </a>                                              
                                                </c:if>
                                            <p:poll interval="3" listener="#{loginManagedBean.pullNotification}" update="newNotification" />
                                        </h:form>
                                    </li>    
                                    <c:forEach var="i" begin="0" end="#{loginManagedBean.notificationList.size()-1}">
                                        <li class="list-group-item">
                                            <a href="#{application.contextPath}#{loginManagedBean.notificationList.get(i).link}">
                                                <div class="m-body">
                                                    <small><h6>#{loginManagedBean.notificationList.get(i).title}:</h6></small>
                                                    <span>#{loginManagedBean.notificationList.get(i).content}</span><br></br>
                                                    <span class="small"><i class="fa fa-clock-o"></i> </span>
                                                </div>
                                            </a>
                                        </li>
                                    </c:forEach>
                                </ul>
                            </div>
                        </div>
                    </li>


                    <li class="dropdown">
                        <a href="#" data-toggle="dropdown">
                            <i class="fa fa-cogs"></i>
                        </a>
                        <ul class="dropdown-menu">
                            <li>
                                <h:link value="View Employee Record" outcome="modifyparticulars"/>
                            </li>
                            <li>
                                <h:link value="Change Password" outcome="changepassword"/>
                            </li>
                            <li class="divider"></li>
                            <li>
                                <a href="#">Notification Settings</a>
                            </li>
                        </ul>
                    </li>

                    <li class="off-right">
                        <h:form>
                            <h:commandLink value="Logout" action="#{dashManagedBean.logout}" />
                        </h:form>
                    </li>
                </ul>
            </header>
            <!-- /top header -->

            <section class="layout">
                <!-- sidebar menu -->
                <aside class="sidebar offscreen-left">
                    <!-- main navigation -->
                    <nav class="main-navigation" data-height="auto" data-size="6px" data-distance="0" data-rail-visible="true" data-wheel-step="10">

                        <ul class="nav user-info">
                            <li>
                                <h:link outcome="modifyparticulars">
                                    <img src="#{application.contextPath}/assets/img/avatar.png" class="user-avatar pull-left" alt="User Avatar"></img>
                                    <span class="user-info">
                                        #{dashManagedBean.name}<br></br>
                                        #{dashManagedBean.plantName} #{dashManagedBean.plantType}<br></br>
                                        #{dashManagedBean.countryName}
                                    </span>
                                </h:link>
                            </li>
                        </ul> 

                        <p class="nav-title">MENU</p>
                        <ul class="nav sidenav">  
                           <h:outputText value="#{loginManagedBean.menu}" escape="false" />
                        </ul>
                    </nav>
                </aside>
                <!-- /sidebar menu -->

                <!-- main content starts here -->
                <section class="main-content">

                    <!-- content wrapper -->
                    <div class="content-wrap">

                        <!-- inner content wrapper -->
                        <div class="wrapper">

                            <ui:insert name="content" >Content</ui:insert>

                        </div>
                        <!-- /inner content wrapper -->

                    </div>
                    <!-- /content wrapper -->
                    <a class="exit-offscreen"></a>
                </section>
                <!-- /main content -->
            </section>
        </div>
        <!-- core scripts -->
        <script src="#{application.contextPath}/assets/plugins/jquery-1.11.1.min.js"></script>
        <script src="#{application.contextPath}/assets/bootstrap/js/bootstrap.min.js"></script>
        <script src="#{application.contextPath}/assets/plugins/jquery.slimscroll.min.js"></script>
        <!-- template scripts -->
        <script src="#{application.contextPath}/assets/js/offscreen.js"></script>
        <script src="#{application.contextPath}/assets/js/navigation.js"></script>
        <!-- for calendar, TODO: try to move to dash -->
        <link rel="stylesheet" href="#{application.contextPath}/assets/plugins/calendar/bootstrap_calendar.css"></link>
        <script src="#{application.contextPath}/assets/plugins/calendar/bootstrap_calendar.js"></script>

    </h:body>
</html>

